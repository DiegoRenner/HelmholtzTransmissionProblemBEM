x = linspace(0.01, 10, 500);
rsv = [0.975959 0.975504 0.974584 0.973143 0.971093 0.968315 0.964653 0.959909 0.953837 0.946145 0.936495 0.924525 0.909883 0.892281 0.871573 0.847838 0.821446 0.79308 0.763684 0.734344 0.706141 0.68001 0.65666 0.636555 0.619947 0.606934 0.597523 0.591675 0.589343 0.590485 0.595079 0.603115 0.61459 0.629492 0.647763 0.669255 0.693657 0.720396 0.748502 0.776396 0.801418 0.818273 0.818782 0.805211 0.785247 0.761771 0.735738 0.707719 0.678298 0.648159 0.618034 0.588611 0.560423 0.533804 0.508884 0.485628 0.463896 0.443496 0.424223 0.405895 0.388364 0.371527 0.355325 0.339738 0.324786 0.310519 0.297017 0.284385 0.27275 0.262242 0.252933 0.24502 0.238767 0.234358 0.231942 0.231631 0.233488 0.237521 0.243685 0.251887 0.262 0.273877 0.287366 0.302316 0.318591 0.336074 0.354676 0.374343 0.395057 0.416735 0.439159 0.462318 0.486344 0.511333 0.537316 0.503097 0.395018 0.32936 0.292536 0.268685 0.250064 0.233481 0.217719 0.202361 0.187312 0.17262 0.158422 0.144931 0.132449 0.121395 0.112305 0.105817 0.102559 0.102971 0.107137 0.114763 0.125317 0.138207 0.152874 0.168666 0.177263 0.166355 0.154542 0.143027 0.132078 0.121965 0.113025 0.105679 0.100411 0.0977043 0.0979242 0.101206 0.107418 0.116233 0.127242 0.140045 0.154302 0.169737 0.18614 0.203356 0.221305 0.240052 0.260099 0.268935 0.254435 0.240513 0.226812 0.213136 0.199261 0.18461 0.169091 0.154621 0.141182 0.12831 0.115959 0.104301 0.0936554 0.0844884 0.0774216 0.0711948 0.0669199 0.0663291 0.0695962 0.0762911 0.0856616 0.0969678 0.10963 0.123234 0.137485 0.152162 0.167088 0.182091 0.196992 0.211577 0.225588 0.238713 0.250603 0.260913 0.269371 0.275861 0.280501 0.283666 0.285947 0.288016 0.290432 0.293647 0.298168 0.281881 0.211644 0.181838 0.163665 0.148285 0.133426 0.118574 0.103655 0.0887086 0.0738345 0.0592282 0.0453716 0.0335775 0.0272532 0.0306051 0.0417695 0.0565613 0.0727106 0.0859677 0.0810252 0.0691169 0.0562672 0.0430627 0.029666 0.0162905 0.00528848 0.0135426 0.0273124 0.0415804 0.0560767 0.0707413 0.0855481 0.100481 0.115528 0.130683 0.145957 0.161403 0.177153 0.193424 0.210488 0.228815 0.24624 0.230364 0.213446 0.198543 0.184278 0.169757 0.155112 0.141393 0.128386 0.115592 0.102868 0.0902499 0.0778626 0.0659337 0.0548799 0.0454821 0.039114 0.0375233 0.0345439 0.0297578 0.0310124 0.0376877 0.0474276 0.0584154 0.0694372 0.0793836 0.0870467 0.0913494 0.0919285 0.0895592 0.0859078 0.0828269 0.0817696 0.0835349 0.088279 0.0957146 0.105366 0.116756 0.129483 0.143238 0.15779 0.172973 0.18869 0.204904 0.221467 0.23821 0.208321 0.152894 0.132399 0.118459 0.105707 0.0930735 0.0803461 0.0675209 0.0546922 0.0419448 0.0293221 0.0170588 0.0073747 0.0122602 0.0239576 0.0361308 0.0476466 0.0561027 0.0561921 0.0503556 0.0440208 0.0394875 0.0381592 0.0406368 0.0464466 0.0546071 0.0642731 0.074893 0.0861341 0.0977954 0.109751 0.121918 0.134242 0.146692 0.159295 0.172266 0.186359 0.202632 0.215701 0.170273 0.149951 0.14524 0.152312 0.177464 0.177511 0.132309 0.113765 0.100404 0.0877966 0.0752431 0.0626882 0.0502347 0.0381572 0.0272313 0.0199145 0.0210118 0.0300881 0.0309412 0.0252789 0.0281667 0.0394416 0.0550426 0.0676305 0.0661653 0.0524551 0.0371259 0.0248804 0.0184043 0.0208857 0.0296108 0.0407337 0.0528642 0.0655493 0.0785986 0.0919065 0.1054 0.11902 0.132718 0.146491 0.160621 0.176981 0.200802 0.223874 0.235 0.157577 0.134636 0.121077 0.108969 0.0970197 0.0850149 0.0729787 0.0609991 0.0491137 0.0372966 0.025522 0.0137825 0.00274845 0.0108853 0.023346 0.0364317 0.0502492 0.0606277 0.0642125 0.0626171 0.0603035 0.0585829 0.0582558 0.0596879 0.0629017 0.0676943 0.0737647 0.0808319 0.0888505 0.0988087 0.112698 0.122349 0.100514 0.0775424 0.0562759 0.0347449 0.0127507 0.00975365 0.0327759 0.0563273 0.080408 0.105061 0.130606 0.148923 0.120474 0.106155 0.0940085 0.0821327 0.0702048 0.0581645 0.0460004 0.0337097 0.0213067 0.00896308 0.00543008 0.0179081 0.0313852 0.0303155 0.0159949 0.0190906 0.052903 0.142569 0.239601 0.0947563 0.0614806 0.0401996 0.0225211 0.0105078 0.0185877 0.0344746 0.0512731 0.0682816 0.0854032 0.102669 0.113772 0.12402 0.134832 0.146274 0.158672 0.173397 0.196863 0.262011 0.36743 0.174501 0.135353 0.121349 0.108432 0.0952813 0.0826822 0.0708148 0.059325 0.0478855 0.0363853 0.0248132 0.0131757 0.00200907 0.0108146 0.0229642 0.0354577 0.0207422 0.0201192 0.0352695 0.0550815 0.0768786 0.0969729 0.0900282 0.088529 0.0882179 0.0873762 0.0861606 0.0854752 0.0863571 0.087232 0.0851132 0.0818929 0.0806888 0.0743853 0.0675859 0.0655372 0.0687084 0.0765965 0.0881213 0.102253 0.118314 0.136034 0.15508 0.153477 0.115172 0.0992491 0.0870952 0.0755373 0.0640195 0.0524452 0.0407948 0.0290664 0.0172749 0.00563828 0.00730862 0.0193581 0.0318357 0.0417048 0.0237093];
asv = [0.736956 0.735546 0.73293 0.729171 0.724306 0.718371 0.711408 0.703467 0.69461 0.68491 0.67445 0.663323 0.651634 0.639492 0.627019 0.614341 0.601595 0.58892 0.576463 0.564373 0.552801 0.541896 0.531802 0.522654 0.514575 0.507669 0.502015 0.497669 0.494654 0.492962 0.492554 0.493363 0.495294 0.498231 0.502042 0.506589 0.511725 0.517308 0.523198 0.529268 0.535398 0.541483 0.547431 0.553163 0.558614 0.563731 0.568471 0.572002 0.556341 0.540309 0.523922 0.507204 0.490181 0.472886 0.455358 0.437642 0.419789 0.401856 0.383906 0.366011 0.348244 0.330688 0.313387 0.296477 0.280056 0.264232 0.249113 0.234816 0.221461 0.209169 0.19806 0.188246 0.179825 0.172874 0.167437 0.163517 0.161073 0.160023 0.160244 0.16159 0.163897 0.166999 0.170738 0.174966 0.179555 0.184392 0.189383 0.194448 0.199524 0.204558 0.20951 0.214346 0.219041 0.223577 0.22794 0.232118 0.219353 0.20413 0.189347 0.175023 0.161178 0.147832 0.13501 0.122742 0.111066 0.100032 0.0897087 0.0801905 0.0716064 0.0641286 0.0579735 0.0533828 0.0505693 0.0496317 0.0504884 0.0528874 0.0564892 0.0609576 0.0660101 0.0714295 0.0770514 0.0827306 0.0880501 0.0848619 0.0766531 0.0690317 0.0623175 0.0567146 0.0524178 0.0495873 0.048297 0.0484911 0.0499867 0.052524 0.0558305 0.0596652 0.0638359 0.068198 0.0726468 0.0771077 0.0815282 0.0858719 0.0901141 0.0942382 0.0982334 0.102094 0.0988598 0.0909461 0.0832709 0.0758523 0.0687093 0.0618642 0.0553441 0.0491847 0.043435 0.0381634 0.0334673 0.0294808 0.0263748 0.0235383 0.0216062 0.02091 0.0214183 0.0229156 0.0251071 0.0277247 0.0305676 0.033497 0.0364185 0.0392673 0.0419976 0.044576 0.046978 0.0491859 0.0511887 0.0529823 0.0545702 0.0559652 0.0571907 0.0582809 0.0592807 0.060244 0.0612298 0.0622974 0.063501 0.0648834 0.0664726 0.0682793 0.0619769 0.0558009 0.0498657 0.0441658 0.0386965 0.0334552 0.0284424 0.0236645 0.0191397 0.0149114 0.0110882 0.00796118 0.00626541 0.00681851 0.00901456 0.0118281 0.014788 0.0176849 0.0201287 0.0189477 0.015226 0.0114064 0.00768345 0.00412514 0.00130952 0.00327996 0.006472 0.00964321 0.0127326 0.0157314 0.0186389 0.0214569 0.0241881 0.0268351 0.0294006 0.0318871 0.0342967 0.0366309 0.0388904 0.041074 0.0431776 0.0451903 0.0470859 0.0487969 0.0492006 0.0445354 0.0400614 0.035775 0.0316741 0.027759 0.024034 0.0205092 0.0172048 0.0141597 0.0114476 0.00920694 0.00767505 0.00712646 0.00614712 0.00509605 0.00509512 0.00592056 0.00710226 0.00832234 0.00941789 0.0103049 0.0109427 0.0113248 0.0114816 0.0114843 0.0114462 0.0115117 0.0118267 0.0124973 0.0135585 0.0149778 0.0166834 0.018595 0.0206407 0.0227632 0.0249197 0.027079 0.0292195 0.0313262 0.0333896 0.0354036 0.0333075 0.0300159 0.0268414 0.0237787 0.0208233 0.0179707 0.0152173 0.0125602 0.00999769 0.00753079 0.00516803 0.00295145 0.00125295 0.00204685 0.00393515 0.00585416 0.00767145 0.00920744 0.0096489 0.00860368 0.00737598 0.00648545 0.00614748 0.00642579 0.00721306 0.00833266 0.00964085 0.0110468 0.0124972 0.0139609 0.015419 0.0168595 0.0182742 0.0196572 0.0210042 0.0223117 0.0235776 0.0248018 0.0259869 0.02714 0.0279116 0.0268062 0.02666 0.0274533 0.0255741 0.0227192 0.0199714 0.0173276 0.0147863 0.0123485 0.0100195 0.00781408 0.00577044 0.00399741 0.00283101 0.00288259 0.00396269 0.00335735 0.00251565 0.00251053 0.00306499 0.00367957 0.0040827 0.00415171 0.00385314 0.0032406 0.00248758 0.00202066 0.00243475 0.00357786 0.00501756 0.00656418 0.00814265 0.00971785 0.0112715 0.0127937 0.0142792 0.0157253 0.0171312 0.0184966 0.0198217 0.021107 0.0223525 0.0235579 0.0237666 0.0214132 0.0191391 0.0169415 0.0148177 0.0127652 0.0107818 0.00886516 0.00701355 0.00522552 0.00350069 0.00184295 0.000356307 0.00136612 0.00283553 0.00424789 0.00558146 0.00679536 0.00773438 0.00794677 0.00757271 0.00719474 0.00699567 0.00701219 0.00722977 0.00760803 0.00809675 0.00864609 0.00921147 0.00975606 0.0102546 0.0107006 0.0111129 0.0104003 0.00742014 0.00448798 0.00161138 0.00120494 0.00395585 0.00663913 0.00925246 0.0117942 0.014263 0.0166583 0.0172336 0.0151781 0.0131939 0.0112772 0.00942476 0.00763344 0.00590074 0.00422511 0.00260783 0.00107023 0.000631518 0.00202313 0.00342825 0.00230323 0.00106011 0.00103583 0.00208279 0.00313436 0.00402658 0.00471546 0.00520855 0.00404951 0.00231021 0.00107824 0.00189232 0.0034669 0.00507924 0.00664831 0.00815424 0.00958812 0.0106526 0.0114662 0.0122865 0.0131057 0.0139166 0.014712 0.0154825 0.0162144 0.0167179 0.0162655 0.0155646 0.014746 0.0133609 0.0117358 0.0101446 0.00859182 0.00707965 0.00560903 0.00418036 0.00279404 0.00145221 0.000216475 0.00113709 0.00234948 0.00340359 0.00193449 0.0018204 0.00308981 0.00465874 0.00624864 0.00761167 0.00725088 0.00689174 0.00655428 0.00621881 0.00585196 0.00542613 0.00494728 0.00448764 0.00420201 0.00427595 0.0047881 0.0056534 0.00639594 0.00610039 0.00627705 0.00685855 0.00772603 0.00877059 0.00991527 0.0111108 0.0123263 0.013542 0.0137977 0.0121167 0.0104945 0.00892787 0.00741401 0.00595031 0.00453454 0.00316508 0.00184235 0.000588666 0.000746401 0.00193113 0.0030945 0.00281684 0.0014885];
plot(x, rsv, x, asv); hold on;
plot([0.606514, 0.606514], [0, 1], 'g');
plot([1.55964, 1.55964], [0, 1], 'g');
plot([2.27019, 2.27019], [0, 1], 'g');
plot([2.62161, 2.62161], [0, 1], 'g');
plot([3.2376, 3.2376], [0, 1], 'g');
plot([4.0143, 4.0143], [0, 1], 'g');
plot([4.25745, 4.25745], [0, 1], 'g');
plot([4.9691, 4.9691], [0, 1], 'g');
plot([5.17642, 5.17642], [0, 1], 'g');
plot([5.74189, 5.74189], [0, 1], 'g');
plot([5.92878, 5.92878], [0, 1], 'g');
plot([6.33321, 6.33321], [0, 1], 'g');
plot([6.59373, 6.59373], [0, 1], 'g');
plot([6.66692, 6.66692], [0, 1], 'g');
plot([6.82894, 6.82894], [0, 1], 'g');
plot([7.41042, 7.41042], [0, 1], 'g');
plot([7.63443, 7.63443], [0, 1], 'g');
plot([7.91042, 7.91042], [0, 1], 'g');
plot([8.25241, 8.25241], [0, 1], 'g');
plot([8.3336, 8.3336], [0, 1], 'g');
plot([8.50783, 8.50783], [0, 1], 'g');
plot([9.06888, 9.06888], [0, 1], 'g');
plot([9.17361, 9.17361], [0, 1], 'g');
plot([9.40587, 9.40587], [0, 1], 'g');
plot([9.53334, 9.53334], [0, 1], 'g');
plot([9.89361, 9.89361], [0, 1], 'g');
hold off;
legend('Randomized SVD', 'Arnoldi iterations');
xlabel('Wavenumber k'); ylabel('Smallest singular value');
